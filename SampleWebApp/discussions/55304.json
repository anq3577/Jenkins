[
  {
    "Id": "186743",
    "ThreadId": "55304",
    "Html": "Has anyone else noticed that when trying to edit a forum topic, under the forum management section; that noting gets updated?  Try changing the Monitor to someone else or updating the check boxes, such as &quot;locked&quot;.  Noting updates.<br>\r\n<br>\r\nIf so, does anyone have a fix for this yet?<br>\r\n",
    "PostedDate": "2009-05-04T17:18:41.253-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "248317",
    "ThreadId": "55304",
    "Html": "<p>Yes, the Subroutine Page_Load in Manage.aspx is the problem.&nbsp; When you first press the edit link it loads the page and fills in the values so you can edit them, however it also does this when you post your changes.&nbsp; So the changes you make get set back to the original database setting before your new values get a chance to update.</p>\r\n<p>In short, this page is the same page called to both intitated the edit (it&nbsp;fills in your input boxes for you to edit) and also the same page that your changes are posted to (but overwritten by the logic that fills in your input boxes in the first call).</p>\r\n<p>Luckily it is easy enough to detect the difference between the two.&nbsp; When clicking the 'edit' link, it is simply calling the page like a form get request would do.&nbsp; When clicking the update button to save your changes it calls the page like a form post does (posting the changes).&nbsp; So simply test Request.ContentLength and if it is zero, go ahead and let the original logic for the page happen, but if not do not let that logic overwrite your changes.&nbsp; here is the updated Page_Load subroutine:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Blue\">Protected</span> <span style=\"color:Blue\">Sub</span> Page_Load(<span style=\"color:Blue\">ByVal</span> sender <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">Object</span>, <span style=\"color:Blue\">ByVal</span> e <span style=\"color:Blue\">As</span> System.EventArgs)\r\n        <span style=\"color:Blue\">If</span> Request(<span style=\"color:#A31515\">&quot;editid&quot;</span>) <span style=\"color:Blue\">Is</span> <span style=\"color:Blue\">Nothing</span> <span style=\"color:Blue\">Then</span>\r\n            AddTopic.Visible = <span style=\"color:Blue\">True</span>\r\n            UpdateTopic.Visible = <span style=\"color:Blue\">False</span>\r\n        <span style=\"color:Blue\">Else</span>\r\n            AddTopic.Visible = <span style=\"color:Blue\">False</span>\r\n            UpdateTopic.Visible = <span style=\"color:Blue\">True</span>\r\n            <span style=\"color:Blue\">Dim</span> topic <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">New</span> Topics(Topics.Columns.Topicid, Request(<span style=\"color:#A31515\">&quot;editid&quot;</span>))\r\n            <span style=\"color:Blue\">If</span> Request.ContentLength = 0 <span style=\"color:Blue\">Then</span>\r\n                TopicName.Text = topic.Topic\r\n                Description.Text = topic.Description\r\n                SectionCHECK.Checked = topic.Section\r\n                VisibleCHECK.Checked = topic.Visible\r\n                LockedCHECK.Checked = topic.Locked\r\n                Weight.Text = topic.Weight.ToString()\r\n                DropDownList1.SelectedValue = topic.Moderatorkey.ToString()\r\n            <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span> \r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span>\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-10-21T15:32:12.25-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]